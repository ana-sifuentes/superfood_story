
<html lang="en">

<meta name="viewport" content="width=device-width, initial-scale=1" />

<head>
    <meta charset="UTF-8">
    <title> SUPERFOOD STORY </title>
</head>



<style>

@font-face {
  font-family: VCR_OSD_MONO;
  src: url("assets/VCR_OSD_MONO_1.001.ttf");
}





/**********************/
/* MENU */

	.menu.wrapper{
		width:100%;
		height:70px;
		margin-top:10px;
		font-family: 'VCR_OSD_MONO';
	}


	.menu.main{
	 	float: left;
    		width: 18%;
    		padding: 0px 1%;
    		font-size: 28px;
    		text-align: left;
		font-weight: 800;
	}

	.menu.spacer{
    		float: left;
    		width: 44%;
    		height: 1px;
	}

	.menu.item{
    		float: left;
    		width: 8%;
    		margin: 10px 2%;
    		padding: 8px 0px;
    		font-size: 20px;
    		text-align: center;
	}


	a > .menu.item {
		color:black;
	}

	.menu.item.current,
	.menu.item:hover{
		border-bottom:2px solid black;
	}


/**********************/



/* fonts */

  p{
		font-family: 'VCR_OSD_MONO';
		text-align:center;
	}

	h1, h2, h3, h4, h5, h6, p{
		font-family: 'VCR_OSD_MONO';
	}


/**********************/
/* GAME */


*{
    padding: 0;
    margin: 0;
    overflow-x: hidden;
}

#character{
    width: 81px;  /*20*/
    height: 98px; /*50*/
    background-image:url("assets/chia_seed.png");
    position:relative;
    top: 202px;
}
.animate{
    animation: jump 0.3s linear;
}


@keyframes jump{
    0%{top: 202px;}
    30%{top: 100px;}
    70%{top: 100px;}
    100%{top: 202px;}
}

#block{
    width: 30px; /*20*/
    height: 20px;
    position: relative;
    top: 185px;
    left: 800px;
    background-image:url("assets/fireball.png");
    animation: block 1s infinite linear;
}



@keyframes block{
    0%{left: 800px}
    100%{left: -30px}
}




.game{
  width: 100%;
  height: 400px;
  border: 1px solid black;
  margin: auto;
  max-width: 600px;
}

  .mobile_button{
      width: 50%;
      max-width: 600px;
      text-align: center;
      cursor: pointer;
      border: 1px solid black;
      height: 40px;
      font-family: 'VCR_OSD_MONO';
      padding: 4vh 0px 2vh 0px;
      background-color: #BEBFB9;
      margin: 2vh auto;
      font-size: 25px;
  }

  .mobile_button:hover{
    background-color: #E1E1DF;
  }



#score_points.off{
display:none;
}
 #score_points{
	display:block;
}


/****************/
/* levels */


.levels{
  float: left;
  height: 400px;
  width: 100%;
  position: relative;
  display: none;
  background-repeat: no-repeat;
  background-position-x: 0%;
}

.levels.current{
  display: block;
}

/*welcome screen*/
.levels.current.lvl_0{
  display: block;
  text-align: center;
  background-position-y:100%;
  background-repeat: repeat-y;
  background-size: cover;
  animation: 60s welcome_screen_animation linear alternate infinite;
  background-image: url('game assets/welcome_screen.svg');
}

@keyframes welcome_screen_animation {
    from {
        background-position-y: 100%
    }
    to {
        background-position-y: 0%
    }
}

#welcome_screen > h3{
  font-weight: 900;
  font-size: 50px;
  line-height: normal;
  top: 35%;
  position: relative;
  width: 75%;
  background-color: white;
  margin: auto;
}

#welcome_screen p{
  top: 38%;
  position: relative;
}




/*mesoamerica*/
.levels.current.lvl_1{
  display: block;
  background-position-x: 0%;
  animation: 30s level_animation linear infinite;
  background-image: url(https://via.placeholder.com/2000x400/FFFFFF/000000?text=LEVEL_1);
}

/*colonization*/
.levels.current.lvl_2{
  display: block;
  background-position-x: 0%;
  animation: 30s level_animation linear infinite;
  background-image: url(https://via.placeholder.com/2000x400/FFFF00/000000?text=LEVEL_2);
}

/*rediscovery*/
.levels.current.lvl_3{
  display: block;
  background-position-x: 0%;
  animation: 30s level_animation linear infinite;
  background-image: url(https://via.placeholder.com/2000x400/FF0000/000000?text=LEVEL_3);
}

/*modernity*/
.levels.current.lvl_4{
  display: block;
  background-position-x: 0%;
  animation: 30s level_animation linear infinite;
  background-image: url(https://via.placeholder.com/2000x400/0000FF/000000?text=LEVEL_4);
}


@keyframes level_animation {
    from {
        background-position-x: 0%
    }
    to {
        background-position-x: 100%
    }
}


/*GAME ENDED*/
.levels.current.lvl_5{
  display: block;
  background-position-x: 0%;
  background-image: url(https://via.placeholder.com/600x400?text=GAME_END);
}


/***********************************************************************/

/* MOBILE */
@media only screen and (max-width: 450px) {

  .game{  max-width: 300px;}

  .levels.current.lvl_0{
    animation: 20s welcome_screen_animation linear alternate infinite;
  }
  #welcome_screen > h3{width: 100%}

}



</style>







<body>
  <div class="menu wrapper">

    <div class="menu main" id="main_logo">
    <p> SUPERFOOD <BR> STORY </p>
    </div>

	<div class="menu spacer"> <p></p></div>


	<a href="/superfood_story/index">
	<div class="menu item current">
    	<p> GAME  </p>
        </div>
	</a>

	<a href="/superfood_story/article">
	<div class="menu item ">
    	<p> ARTICLE  </p>
    	</div>
	</a>

	<a href="/superfood_story/article#credits">
	<div class="menu item">
    	<p> CREDITS </p>
    	</div>
	</a>

  </div>







  <div class="game">


	        <div id="welcome_screen" class="levels lvl_0 current">

              <h3>SUPERFOOD STORY</h3>

		          <p> PRESS SPACE </p>

	        </div>


          <div class="level_data">

            <div id="score_display">SCORE: 
              <span id="score_points" class="off"></span>
            </div>


            <div class="volume" style="width: 10%;margin: auto;max-width: 80px;text-align: center; 
            font-family: 'VCR_OSD_MONO';
              height: 20px;
              padding: 10px 0px;
              font-size: 20px;
              background-color: #BEBFB9;
              margin-bottom: 2vh;">
              Stop
            </div>
            
          </div>
          
	         <div id="levels" class="levels lvl_1">
             <div id="character"></div>
             <div id="block"></div>
	         </div>

  </div>




    <div id="mobile_button" class="mobile_button">
        SPACE
    </div>


    


	</div>
	</div>

</body>





<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
//based on the code by : https://github.com/Beat0154



$(document).ready(function() {


  
  //variables
  var character = document.getElementById("character");
  var block = document.getElementById("block");


  //counter set to 0 before stage 1
  var counter=0;
  var game_stage=0;



  //check if player makes points 

  var check_lose_points = setInterval(function() {
    
      let characterTop = parseInt(window.getComputedStyle(character).getPropertyValue("top"));
      let blockLeft = parseInt(window.getComputedStyle(block).getPropertyValue("left"));

      if(blockLeft<70 && blockLeft>-20 && characterTop>=185){
        
          block.style.animation = "none";
        //  alert("Game Over. score: "+Math.floor(counter/100));
          counter--;
          if(counter< 0){
            counter= 0;
          }
          
          block.style.animation = "block 1s infinite linear";
      }else{
          counter++;
          document.getElementById("score_points").innerHTML = Math.floor(counter/100);
      }
  }, 10)



  ////////////////////////////////////////////////////////////////////////
  //user clicks space or button

    //when the user clicks
    document.body.onkeyup = function(e){
        if(e.keyCode == 32){

          if(game_stage == 0){
             title_screen();
          }

          if(game_stage > 0 && game_stage <5){
             jump();
          }

          if(game_stage == 5){
            location.reload();
          }

      }
    }

  		$('#mobile_button').click(function(){

        if(game_stage == 0){
           title_screen();
        }

        if(game_stage > 0 && game_stage <5){
           jump();
        }

        if(game_stage == 5){
          location.reload();
        }

      });


      
////////////////////////////////////////////////////////////////////////
//audio

  var audio_music = document.createElement('audio');
  audio_music.setAttribute('src', 'game assets/aztec fall.wav');
  audio_music.setAttribute('autoplay', 'autoplay');
  
  //audio_music.load()
  $.get();
      audio_music.addEventListener("load", function() {
      audio_music.play();
  }, true);




  $('.play').click(function() {
    audio_music.play();
  });


  $('.pause').click(function() {
    audio_music.pause();
  });



});




////////////////////////////////////////////////////////////////////////
//functions

    //title screen
    function title_screen(){

      //remove the title screen and show score
      $('#welcome_screen').removeClass('current');
      $('#score_points').removeClass('off');

      //switch to levels
      $("#levels").addClass('current');

      game_stage = 1;
      counter=0;

      change_lvl();
    }


    //player jumps
    function jump(){
        if(character.classList == "animate"){return}
        character.classList.add("animate");
        setTimeout(function(){
            character.classList.remove("animate");
        },300);
    }


    //start levels
    function change_lvl(){


        console.log('gaming begins!');


        var intervalId = window.setInterval(function(){


              $("#levels").removeClass('lvl_'+game_stage);

              console.log('lvl is now' + game_stage);


              game_stage = game_stage+1;
              $("#levels").addClass('lvl_'+game_stage);


              //make sure it doesnt go above 5, if so the game is over
              if(game_stage >= 5){

                  game_stage = 5;
                  clearInterval(intervalId);

                  console.log('the game is over');
                  end_game();

              }

        }, 30000); //every 30 seconds change lvl

    }


    function end_game(){

      //hide character
       $('#character').hide();
       $('#block').hide();
       $('#score_display').hide();

    }


</script>
</html>
