
<html lang="en">

<meta name="viewport" content="width=device-width, initial-scale=1" />

<head>
    <meta charset="UTF-8">
    <title> SUPERFOOD STORY </title>
</head>



<style>

@font-face {
  font-family: VCR_OSD_MONO;
  src: url("assets/VCR_OSD_MONO_1.001.ttf");
}

/*****************************************************************/
/* MENU */

	.menu.wrapper{
		width:100%;
		height:70px;
		margin-top:10px;
		font-family: 'VCR_OSD_MONO';
	}


	.menu.main{
	 	float: left;
    		width: 18%;
    		padding: 0px 1%;
    		font-size: 28px;
    		text-align: left;
		font-weight: 800;
	}

	.menu.spacer{
    		float: left;
    		width: 44%;
    		height: 1px;
	}

	.menu.item{
    		float: left;
    		width: 8%;
    		margin: 10px 2%;
    		padding: 8px 0px;
    		font-size: 20px;
    		text-align: center;
	}


	a > .menu.item {
		color:black;
	}

	.menu.item.current,
	.menu.item:hover{
		border-bottom:2px solid black;
	}


/*****************************************************************/

/* fonts */

  p{
		font-family: 'VCR_OSD_MONO';
		text-align:center;
	}

	h1, h2, h3, h4, h5, h6 {
		font-family: 'VCR_OSD_MONO';
	}

/*****************************************************************/
/* GAME */

*{
    padding: 0;
    margin: 0;
    overflow-x: hidden;
}

#character{
    width: 81px;  /*20*/
    height: 98px; /*50*/
    background-image:url("assets/chia_seed.png");
    position:relative;
    top: 202px;
}
.animate{
    animation: jump 0.3s linear;
}


@keyframes jump{
    0%{top: 202px;}
    30%{top: 100px;}
    70%{top: 100px;}
    100%{top: 202px;}
}

#block{
    width: 30px; /*20*/
    height: 20px;
    position: relative;
    top: 185px;
    left: 800px;
    background-image:url("assets/fireball.png");
    animation: block 1s infinite linear;
}

@keyframes block{
    0%{left: 100%}
    100%{left: -5%}
}

.point{
    width: 30px; /*20*/
    height: 30px;
    background-color: blue;
    position: relative;
    top: 185px;
    left: 200px
    display: none;
  /*  animation: block 1s infinite linear;*/
}

.point.showing{
  display: block;
}

@keyframes block{
    0%{left: 800px}
    100%{left: -30px}
}


.game{
  width: 100%;
  height: 400px;
  border: 1px solid black;
  margin: auto;
  max-width: 600px;
}





/*****************************************************************/
/* level data */

.level_data{
    width: 100%;
    height: auto;
    border: 1px solid black;
    margin: auto;
    max-width: 600px;
    font-family: 'VCR_OSD_MONO';
    font-size: 20px;
    margin-bottom: 2vh;
    color:#ffffff;
  }

  .level_data.playing{
    color:#000000;
  }

  .level_data > .column{
    width:33%;
    float:left;
  }

  .level_data > .column.level{
    text-align: center;
  }

  .level_data > .column.volume{
    cursor:pointer;
    text-align: right;
    color:#000000;
  }

  .level_data >  .column.volume > .volume_control.on::before{
    content:'ON';
  }

  .level_data >  .column.volume > .volume_control.off::before{
    content:'OFF';
  }


/*****************************************************************/
/* levels */

.levels{
  float: left;
  height: 400px;
  width: 100%;
  position: relative;
  display: none;
  background-repeat: no-repeat;
  background-position-x: 0%;
}

.levels.current{
  display: block;
}

/*welcome screen*/
.levels.current.lvl_0{
  display: block;
  text-align: center;
  background-position-y:100%;
  background-repeat: repeat-y;
  background-size: cover;
  animation: 60s welcome_screen_animation linear alternate infinite;
  background-image: url('game assets/welcome_screen.svg');
}

@keyframes welcome_screen_animation {
    from {
        background-position-y: 100%
    }
    to {
        background-position-y: 0%
    }
}

#welcome_screen > h3{
  font-weight: 900;
  font-size: 50px;
  line-height: normal;
  top: 35%;
  position: relative;
  width: 75%;
  background-color: white;
  margin: auto;
}

#welcome_screen p{
  top: 38%;
  position: relative;
}




/*mesoamerica*/
.levels.current.lvl_1{
  display: block;
  background-position-x: 0%;
  animation: 30s level_animation linear infinite;
  background-image: url(https://via.placeholder.com/2000x400/FFFFFF/000000?text=LEVEL_1);
}

/*colonization*/
.levels.current.lvl_2{
  display: block;
  background-position-x: 0%;
  animation: 30s level_animation linear infinite;
  background-image: url(https://via.placeholder.com/2000x400/FFFF00/000000?text=LEVEL_2);
}

/*rediscovery*/
.levels.current.lvl_3{
  display: block;
  background-position-x: 0%;
  animation: 30s level_animation linear infinite;
  background-image: url(https://via.placeholder.com/2000x400/FF0000/000000?text=LEVEL_3);
}

/*modernity*/
.levels.current.lvl_4{
  display: block;
  background-position-x: 0%;
  animation: 30s level_animation linear infinite;
  background-image: url(https://via.placeholder.com/2000x400/0000FF/000000?text=LEVEL_4);
}


@keyframes level_animation {
    from {
        background-position-x: 0%
    }
    to {
        background-position-x: 100%
    }
}


/*GAME ENDED*/
.levels.current.lvl_5{
  display: block;
  background-position-x: 0%;
  background-image: url(https://via.placeholder.com/600x400?text=GAME_END);
}


/***********************************************************************/

.mobile_button{
    width: 50%;
    max-width: 600px;
    text-align: center;
    cursor: pointer;
    border: 1px solid black;
    height: 40px;
    font-family: 'VCR_OSD_MONO';
    padding: 4vh 0px 2vh 0px;
    background-color: #BEBFB9;
    margin: 2vh auto;
    font-size: 25px;
}

.mobile_button:hover{
  background-color: #E1E1DF;
}

/***********************************************************************/

/* MOBILE */
@media only screen and (max-width: 450px) {

  .game{  max-width: 300px;}
  .levels.current.lvl_0{ animation: 20s welcome_screen_animation linear alternate infinite;}
  #welcome_screen > h3{width: 100%}

}



</style>







<body>
  <div class="menu wrapper">

    <div class="menu main" id="main_logo">
    <p> SUPERFOOD <BR> STORY </p>
    </div>

	<div class="menu spacer"> <p></p></div>


	<a href="/superfood_story/index">
	<div class="menu item current">
    	<p> GAME  </p>
        </div>
	</a>

	<a href="/superfood_story/article">
	<div class="menu item ">
    	<p> ARTICLE  </p>
    	</div>
	</a>

	<a href="/superfood_story/article#credits">
	<div class="menu item">
    	<p> CREDITS </p>
    	</div>
	</a>

  </div>




  <div class="level_data">

    <div class="column score" id="score">
      SCORE:
      <span id="score_points"> </span>
    </div>

    <div class="column level">
      LEVEL <span id="lvl_number"></span>
    </div>


    <div class="column volume">
      AUDIO:
      <span class="volume_control off" id="volume_control"></span>
    </div>

  </div>


  <div class="game">

	        <div id="welcome_screen" class="levels lvl_0 current">

              <h3>SUPERFOOD STORY</h3>
		          <p> PRESS SPACE </p>

	        </div>


	         <div id="levels" class="levels lvl_1">
             <div id="character"></div>
             <div id="block"></div>
             <div id="point" class="point showing"></div>
	         </div>

  </div>




    <div id="mobile_button" class="mobile_button">
        SPACE
    </div>





	</div>
	</div>

</body>





<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
//based on the code by : https://github.com/Beat0154


//audio files



  //variables
  var character = document.getElementById("character");
  var block = document.getElementById("block");


  //counter set to 0 before stage 1
  var counter=0;
  var game_stage=0;

  var game_ended = false;


  //load music files
  const intro_music = new Audio('game assets/aztec fall.wav');
  intro_music.loop = true;



  //check if player makes points

  var check_lose_points = setInterval(function() {

      let characterTop = parseInt(window.getComputedStyle(character).getPropertyValue("top"));
      let blockLeft = parseInt(window.getComputedStyle(block).getPropertyValue("left"));

      if(blockLeft<70 && blockLeft>-20 && characterTop>=185){

          block.style.animation = "none";
          counter =0;
          block.style.animation = "block 1s infinite linear";

      }else{

          if(game_ended == false){
            counter++;
            document.getElementById("score_points").innerHTML = Math.floor(counter/100);
          }
      }
  }, 10)



  ////////////////////////////////////////////////////////////////////////
  //user clicks space or button

    //when the user clicks
    document.body.onkeyup = function(e){
        if(e.keyCode == 32){

          if(game_stage == 0){
             title_screen();
          }

          if(game_stage > 0 && game_stage <5){
             jump();
          }

          if(game_stage == 5){
            location.reload();
          }

      }
    }

  		$('#mobile_button').click(function(){

        if(game_stage == 0){
           title_screen();
        }

        if(game_stage > 0 && game_stage <5){
           jump();
        }

        if(game_stage == 5){
          location.reload();
        }

      });


    	$('.column.volume').click(function(){

        //mute
        if( $('#volume_control').hasClass('on')  ){

          $('#volume_control').removeClass('on').addClass('off');

          intro_music.muted = true;

        }
        else{ //unmute
          $('#volume_control').removeClass('off').addClass('on');

          play_song(game_stage);

        }
      });



////////////////////////////////////////////////////////////////////////
//functions

    //title screen
    function title_screen(){

      //remove the title screen
      $('#welcome_screen').removeClass('current');

      //show levels screen
      $("#levels").addClass('current');

      //show game data
      $('.level_data').addClass('playing');

      //setupt to switch levels
      game_stage = 1;
      counter=0;

      $("#lvl_number").html(game_stage);

      play_song(game_stage);

      change_lvl();

    }


    //player jumps
    function jump(){
        if(character.classList == "animate"){return}
        character.classList.add("animate");
        setTimeout(function(){
            character.classList.remove("animate");
        },300);
    }


    //start levels
    function change_lvl(){


        console.log('gaming begins!');


        random_point();
        
        var change_lvl_interval = window.setInterval(function(){

              //remove previous lvl
              $("#levels").removeClass('lvl_'+game_stage);

              //add +1 stage
              game_stage = game_stage+1;

              //update music, lvl class and lvl display
              play_song(game_stage);
              $("#levels").addClass('lvl_'+game_stage);
              $("#lvl_number").html(game_stage);


              //make sure it doesnt go above 5, if so the game is over
              if(game_stage >= 5){

                  game_stage = 5;
                  clearInterval(change_lvl_interval);

                  console.log('the game is over');
                  end_game();

              }

        }, 30000); //every 30 seconds change lvl

    }



    function random_point() {

        $('#score_point').toggleClass("showing");
        
        setInterval(function() {
          var number = Math.floor((Math.random() * 10) + 1);

        if(number > 5 ){
           $('#point').toggleClass("showing");
         }
        
        },2000); //every 2 seconds 

    }


  
    function play_song(game_stage){

      //mute all songs

      //depending on the level, play according song

      switch (game_stage) {
        case 0: case 5:
          intro_music.muted = false;
          intro_music.play();
          break;

        case 1: case 2: case 3: case 4:
          intro_music.muted = true;
          break;
        default:

      }

    }


    function end_game(){

      //hide character
       $('#character').hide();
       $('#block').hide();

       $('.column.level').html('GAME OVER');

       game_ended = true;

    }




</script>
</html>
